<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style-n.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <title>DramaKu - Dramas</title>
  </head>
  <body>
    <div class="container-fluid">
      <div class="row flex-wrap">
        <div class="bg-dark col-auto col-md-4 col-lg-3 min-vh-100 d-flex flex-column justify-content-between">
          <div class="bg-dark p-2">
            <a href="#" class="d-flex text-decoration-none mt-2 align-items-center text-white">
              <span class="fs-3">DramaKu</span>
            </a>
            <hr class="text-white my-2">
            <ul class="nav nav-pills flex-column mt-4">
                <li class="nav-item">
                    <a href="#" class="nav-link text-white active" id="dramasToggle">
                      <i class="fas fa-film fa-lg"></i>
                      <span class="fs-5 ms-2 d-none d-sm-inline">Dramas</span>
                      <i class="fas fa-chevron-down ms-2"></i> <!-- Icon untuk menandakan dropdown -->
                    </a>
                    <ul class="nav flex-column ms-3" id="dramasSubmenu" style="display: none;">
                      <li class="nav-item">
                        <a href="CMSValidate.html" class="nav-link text-white active">Validate</a>
                      </li>
                      <li class="nav-item">
                        <a href="CMSInputNewDrama.html" class="nav-link text-white">Input New Drama</a>
                      </li>
                    </ul>
                </li>                  
              <li class="nav-item">
                <a href="CMSCountries.html" class="nav-link text-white">
                  <i class="fas fa-globe fa-lg"></i>
                  <span class="fs-5 ms-2 d-none d-sm-inline">Countries</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="CMSAwards.html" class="nav-link text-white">
                  <i class="fas fa-award fa-lg"></i>
                  <span class="fs-5 ms-2 d-none d-sm-inline">Awards</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="CMSGenres.html" class="nav-link text-white">
                  <i class="fas fa-masks-theater fa-lg"></i>
                  <span class="fs-5 ms-2 d-none d-sm-inline">Genres</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="CMSActors.html" class="nav-link text-white">
                  <i class="fas fa-user fa-lg"></i>
                  <span class="fs-5 ms-2 d-none d-sm-inline">Actors</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="CMSComments.html" class="nav-link text-white">
                  <i class="fas fa-comments fa-lg"></i>
                  <span class="fs-5 ms-2 d-none d-sm-inline">Comments</span>
                </a>
              </li>
              <li class="nav-item">
                <a href="CMSUsers.html" class="nav-link text-white">
                  <i class="fas fa-users fa-lg"></i>
                  <span class="fs-5 ms-2 d-none d-sm-inline">Users</span>
                </a>
              </li>
              <li class="nav-item">
                <div class="dropdown">
                  <button
                    class="btn border-none dropdown-toggle text-white"
                    type="button"
                    id="dropdownMenuButton1"
                    data-bs-toggle="dropdown"
                    aria-expanded="false"
                  >
                    <i class="fas fa-user fa-lg"></i>
                    <span class="fs-5 ms-2 d-none d-sm-inline">Naia</span>
                  </button>
                  <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                    <li>
                      <a class="dropdown-item" href="#">
                        <i class="fas fa-sign-out-alt me-2"></i>
                        Logout
                      </a>
                    </li>
                  </ul>
                </div>
              </li>
            </ul>
          </div>
        </div>

        <!-- Content -->
        <div class="col p-5">
          <form id="commentForm" class="mb-4">
            <div class="row mb-3 align-items-center">
              <label for="filter-comm" class="col-sm-2 col-form-label">Filtered by</label>
              <div class="col-sm-4">
                <select class="form-select" id="filter-comm">
                    <option disabled selected value="">None</option>
                    <option value="approved">Approved</option>
                    <option value="unapproved">Unapproved</option>
                </select>
              </div>
              <label for="shows" class="col-sm-2 col-form-label">Shows</label>
              <div class="col-sm-4 d-flex">
                <select class="form-select" id="shows">
                  <option disabled selected value="">Select</option>
                  <option value="1">1</option>
                  <option value="2">2</option>
                  <option value="3">3</option>
                  <option value="5">5</option>
                  <option value="10">10</option>
                  <option value="15">15</option>
                  <option value="20">20</option>
                  <option value="25">25</option>
                  <option value="30">30</option>
                </select>
                <button type="submit" class="btn btn-success ms-3">Search</button>
              </div>
            </div>
          </form>
          <br>

          <!-- Comments Table -->
          <!-- <h3>List of Comments</h3> -->
          <table class="table table-striped table-hover" id="dramasTable">
            <thead>
              <tr>
                <th class="text-center no-column table-warning">No</th>
                <th class="text-center table-warning">Drama</th>
                <th class="text-center table-warning">Actors</th>
                <th class="text-center table-warning">Genres</th>
                <th class="text-center table-warning">Synopsis</th>
                <th class="text-center table-warning">Status</th>
                <th class="text-center action-column table-warning">Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Data komen akan tampil di sini -->
            </tbody>
          </table>
        </div>

        <!-- Footer -->
        <footer class="footer py-3">
          <div class="container text-center">
              <span class="text-white">Copyright &copy; 2024 | CINELUX | All rights reserved</span>
          </div>
        </footer>
      </div>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const dramasToggle = document.getElementById("dramasToggle");
            const dramasSubmenu = document.getElementById("dramasSubmenu");
          
            dramasToggle.addEventListener("click", (event) => {
              event.preventDefault(); // Mencegah tautan dari memuat halaman baru
              const isVisible = dramasSubmenu.style.display === "block";
              dramasSubmenu.style.display = isVisible ? "none" : "block"; // Toggle visibility
            });
          });
          
        document.addEventListener("DOMContentLoaded", () => {
            const tableBody = document.querySelector("#dramasTable tbody");
            const notificationContainer = document.createElement("div");
            const form = document.getElementById('commentForm');
            form.insertAdjacentElement("afterend", notificationContainer);
        
            let dramas = [
                { no: 1, drama: 'Drama A', actors: 'Actor 1', genres: 'Genre 1', synopsis: 'Amazing storyline and great acting!', status: 'Approved' },
                { no: 2, drama: 'Drama B', actors: 'Actor 2', genres: 'Genre 2', synopsis: 'Good drama but a bit slow in the middle.', status: 'Unapproved' },
                { no: 3, drama: 'Drama C', actors: 'Actor 3', genres: 'Genre 3', synopsis: "One of the best dramas I've ever watched!", status: 'Approved' },
                { no: 4, drama: 'Drama D', actors: 'Actor 4', genres: 'Genre 4', synopsis: "Not up to the mark, expected better.", status: 'Unapproved' },
                { no: 5, drama: 'Drama E', actors: 'Actor 5', genres: 'Genre 5', synopsis: "Good overall but had some predictable moments.", status: 'Approved' }
            ];
        
            function renderTable(filteredDramas = dramas) {
                tableBody.innerHTML = "";
                filteredDramas.forEach((item, index) => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td class="text-center no-column">${item.no}</td>
                        <td>${item.drama}</td>
                        <td>${item.actors}</td>
                        <td>${item.genres}</td>
                        <td class="synopsis-column">${item.synopsis}</td>
                        <td>${item.status}</td>
                        <td class="text-center actions-column">
                            <button class="btn btn-edit" data-index="${index}">Edit</button>
                            <button class="btn btn-delete" data-index="${index}">Delete</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }
        
            function showAlert(message, type) {
                const alertDiv = document.createElement("div");
                alertDiv.className = `alert alert-${type} mt-3`;
                alertDiv.textContent = message;
                notificationContainer.innerHTML = '';
                notificationContainer.appendChild(alertDiv);
        
                setTimeout(() => {
                    alertDiv.remove();
                }, 3000);
            }
        
            function handleEditDrama(index) {
                const newDramaName = prompt("Enter new drama name:", dramas[index].drama);
                const newActors = prompt("Enter new actors:", dramas[index].actors);
                const newGenres = prompt("Enter new genres:", dramas[index].genres);
                const newSynopsis = prompt("Enter new synopsis:", dramas[index].synopsis);
                const newStatus = prompt("Enter new status (Approved/Unapproved):", dramas[index].status);
        
                if (newDramaName && newActors && newGenres && newSynopsis && newStatus) {
                    if (newStatus.toLowerCase() === 'approved' || newStatus.toLowerCase() === 'unapproved') {
                        dramas[index].drama = newDramaName;
                        dramas[index].actors = newActors;
                        dramas[index].genres = newGenres;
                        dramas[index].synopsis = newSynopsis;
                        dramas[index].status = newStatus.charAt(0).toUpperCase() + newStatus.slice(1).toLowerCase(); // Capitalize first letter
        
                        renderTable();
                        showAlert("Drama updated successfully!", "success");
                    } else {
                        showAlert("Invalid status. Please enter 'Approved' or 'Unapproved'.", "warning");
                    }
                } else {
                    showAlert("All fields are required to update the drama.", "warning");
                }
            }
        
            function handleDeleteDrama(index) {
                const confirmed = confirm("Are you sure you want to delete this drama?");
                if (confirmed) {
                    dramas = dramas.filter((_, idx) => idx !== parseInt(index, 10))
                                   .map((item, idx) => ({ ...item, no: idx + 1 }));
                    renderTable();
                    showAlert("Drama deleted successfully!", "danger");
                }
            }
        
            function handleSearch(event) {
                event.preventDefault();
                const filterValue = document.getElementById('filter-comm').value;
                const showValue = parseInt(document.getElementById('shows').value) || dramas.length;
        
                // Filter dramas based on the selected status
                const filteredDramas = dramas.filter(drama => {
                    if (!filterValue) return true; // No filter applied
                    return drama.status.toLowerCase() === filterValue.toLowerCase();
                });
        
                // Limit the number of dramas based on the selected 'shows' value
                const limitedDramas = filteredDramas.slice(0, showValue);
        
                // Render the table with the filtered and limited dramas
                renderTable(limitedDramas);
            }
        
            form.addEventListener("submit", handleSearch);
        
            tableBody.addEventListener("click", (event) => {
                const target = event.target;
                if (target.classList.contains("btn-edit")) {
                    const index = target.dataset.index;
                    handleEditDrama(index);
                } else if (target.classList.contains("btn-delete")) {
                    const index = target.dataset.index;
                    handleDeleteDrama(index);
                }
            });
        
            renderTable();
        });            
    </script>      
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js"></script>
  </body>
</html>
